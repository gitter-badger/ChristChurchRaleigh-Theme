{% macro loop(page) %}
    {% for p in page.children.visible %}
        {% set current_page = (p.active or p.activeChild) ? 'active' : '' %}
		{% set has_children = (p.children.visible.count != 0) ? 'has-children' : '' %}
        <li class="{{ current_page }} {{ has_children }}">
            <a href="{{ p.url }}">{{ p.menu }}</a>
            {% if p.children.visible.count > 0 %}
                <ul class="vertical menu submenu">
                    {{ _self.loop(p) }}
                </ul>
            {% endif %}
        </li>
    {% endfor %}
{% endmacro %}

{# Mobile Offcanvas Navigation #}
<aside class="off-canvas" role="navigation">
	<h1>
		<a href="{{ base_url_absolute }}">
            <img src="{{ url('theme://images/logo.jpg') }}" class="logo" />
        </a>
	</h1>

    <ul class="menu">
        {{ _self.loop(pages) }}
    </ul>

</aside><!--/mobile-menu-->
